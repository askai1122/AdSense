<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Google AdSense Payment Receipt</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Roboto", Arial, sans-serif;
      padding: 20px;
      background: #ffffff;
    }

    .section-title {
      font-size: 27px;
      font-weight: 540;
      margin: 15px 0;
    }

    .table-bordered th,
    .table-bordered td {
      border: 1px solid #000000 !important;
    }

    /* ❌ Hide full content before data comes */
    #content {
      display: none;
    }

    .no-wrap {
      display: flex;
      flex-wrap: nowrap;
    }

    /* .col-fixed {
      flex: none !important;
      width: 400px;
      max-width: none !important;
    } */
    .col-fixed {
      flex: 0 0 37%;
      max-width: 50%;
    }

    /* ===== Responsive for Mobile ===== */
    @media (max-width: 768px) {
      .no-wrap {
        flex-wrap: wrap !important; /* Allow wrapping on small screens */
      }

      .col-fixed {
        flex: 0 0 100% !important;
        max-width: 100% !important;
        margin-bottom: 20px; /* Spacing between stacked columns */
      }

      .section-title {
        font-size: 22px;
      }

      body {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- ✅ This will be hidden until data comes -->
  <div id="content" class="bg-white">
    <div class="row no-wrap">
      <!-- Left Column -->
      <div class="col-fixed">
        <div class="header">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg"
            style="height: 50px"
          />
        </div>
        <div class="address mt-5" style="font-weight: 545 !important;">
          Google Asia Pacific Pte. Ltd.<br />
          70 Pasir Panjang Road, #03-71<br />
          Mapletree Business City<br />
          Singapore 117371<br /><br />

          Tax identification number<br />
          <span name="taxidentification"></span><br /><br />

          <span name="address"></span>
        </div>
      </div>

      <!-- Right Column -->
      <div class="col-fixed">
        <div class="section-title">Payment Receipt</div>

        <div class="row mt-5">
          <div class="col-6"><b>Payment date</b></div>
          <div class="col-6" name="paymentdate"></div>
        </div>
        <div class="row">
          <div class="col-6"><b>Billing ID</b></div>
          <div class="col-6" name="billingid"></div>
        </div>
        <div class="row">
          <div class="col-6"><b>Payment method</b></div>
          <div class="col-6" name="paymentmethod"></div>
        </div>
        <div class="row">
          <div class="col-6"><b>Payment number</b></div>
          <div class="col-6" name="paymentnumber"></div>
        </div>
      </div>
    </div>

    <!-- Table -->
    <div class="col-10 mt-3">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Description</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Payment amount</td>
            <td name="Amount"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function loadData() {
      const urlParams = new URLSearchParams(window.location.search);
      const month = urlParams.get("month") || "first";
      let formKey = "reciptform";

      if (month !== "first") {
        formKey = `${month}monthreciptform`;
      }

      fetch("https://adsense-xq8u.onrender.com/get-data")
        .then((res) => res.json())
        .then((allData) => {
          const sectionData = allData[formKey];
          if (!sectionData) {
            console.warn(`No data found for ${formKey}`);
            return;
          }

          // Fill all dynamic fields
          Object.keys(sectionData).forEach((key) => {
            const value = sectionData[key];
            const elements = document.querySelectorAll(`[name="${key}"]`);

            elements.forEach((element) => {
  const newText = value?.toString() ?? "";

  // If field is expected to contain HTML (like <br>), use innerHTML
  if (key === "address" || key === "taxidentification") {
    element.innerHTML = newText;
  } else {
    element.textContent = newText;
  }
});

          });

          // ✅ Show full content instantly after data is filled
          document.getElementById("content").style.display = "block";
        })
        .catch((err) => console.error("Error loading data:", err));
    }

    // Load data initially
    loadData();

    // Optional: Auto-refresh every 5 seconds
    setInterval(loadData, 5000);
  </script>
</body>
</html>
